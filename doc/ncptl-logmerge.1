.\" Automatically generated by Pod::Man 2.22 (Pod::Simple 3.07)
.\"
.\" Standard preamble:
.\" ========================================================================
.de Sp \" Vertical space (when we can't use .PP)
.if t .sp .5v
.if n .sp
..
.de Vb \" Begin verbatim text
.ft CW
.nf
.ne \\$1
..
.de Ve \" End verbatim text
.ft R
.fi
..
.\" Set up some character translations and predefined strings.  -- will
.\" give an unbreakable dash, \*(PI will give pi, \*(L" will give a left
.\" double quote, and \*(R" will give a right double quote.  \*(C+ will
.\" give a nicer C++.  Capital omega is used to do unbreakable dashes and
.\" therefore won't be available.  \*(C` and \*(C' expand to `' in nroff,
.\" nothing in troff, for use with C<>.
.tr \(*W-
.ds C+ C\v'-.1v'\h'-1p'\s-2+\h'-1p'+\s0\v'.1v'\h'-1p'
.ie n \{\
.    ds -- \(*W-
.    ds PI pi
.    if (\n(.H=4u)&(1m=24u) .ds -- \(*W\h'-12u'\(*W\h'-12u'-\" diablo 10 pitch
.    if (\n(.H=4u)&(1m=20u) .ds -- \(*W\h'-12u'\(*W\h'-8u'-\"  diablo 12 pitch
.    ds L" ""
.    ds R" ""
.    ds C` ""
.    ds C' ""
'br\}
.el\{\
.    ds -- \|\(em\|
.    ds PI \(*p
.    ds L" ``
.    ds R" ''
'br\}
.\"
.\" Escape single quotes in literal strings from groff's Unicode transform.
.ie \n(.g .ds Aq \(aq
.el       .ds Aq '
.\"
.\" If the F register is turned on, we'll generate index entries on stderr for
.\" titles (.TH), headers (.SH), subsections (.SS), items (.Ip), and index
.\" entries marked with X<> in POD.  Of course, you'll have to process the
.\" output yourself in some meaningful fashion.
.ie \nF \{\
.    de IX
.    tm Index:\\$1\t\\n%\t"\\$2"
..
.    nr % 0
.    rr F
.\}
.el \{\
.    de IX
..
.\}
.\"
.\" Accent mark definitions (@(#)ms.acc 1.5 88/02/08 SMI; from UCB 4.2).
.\" Fear.  Run.  Save yourself.  No user-serviceable parts.
.    \" fudge factors for nroff and troff
.if n \{\
.    ds #H 0
.    ds #V .8m
.    ds #F .3m
.    ds #[ \f1
.    ds #] \fP
.\}
.if t \{\
.    ds #H ((1u-(\\\\n(.fu%2u))*.13m)
.    ds #V .6m
.    ds #F 0
.    ds #[ \&
.    ds #] \&
.\}
.    \" simple accents for nroff and troff
.if n \{\
.    ds ' \&
.    ds ` \&
.    ds ^ \&
.    ds , \&
.    ds ~ ~
.    ds /
.\}
.if t \{\
.    ds ' \\k:\h'-(\\n(.wu*8/10-\*(#H)'\'\h"|\\n:u"
.    ds ` \\k:\h'-(\\n(.wu*8/10-\*(#H)'\`\h'|\\n:u'
.    ds ^ \\k:\h'-(\\n(.wu*10/11-\*(#H)'^\h'|\\n:u'
.    ds , \\k:\h'-(\\n(.wu*8/10)',\h'|\\n:u'
.    ds ~ \\k:\h'-(\\n(.wu-\*(#H-.1m)'~\h'|\\n:u'
.    ds / \\k:\h'-(\\n(.wu*8/10-\*(#H)'\z\(sl\h'|\\n:u'
.\}
.    \" troff and (daisy-wheel) nroff accents
.ds : \\k:\h'-(\\n(.wu*8/10-\*(#H+.1m+\*(#F)'\v'-\*(#V'\z.\h'.2m+\*(#F'.\h'|\\n:u'\v'\*(#V'
.ds 8 \h'\*(#H'\(*b\h'-\*(#H'
.ds o \\k:\h'-(\\n(.wu+\w'\(de'u-\*(#H)/2u'\v'-.3n'\*(#[\z\(de\v'.3n'\h'|\\n:u'\*(#]
.ds d- \h'\*(#H'\(pd\h'-\w'~'u'\v'-.25m'\f2\(hy\fP\v'.25m'\h'-\*(#H'
.ds D- D\\k:\h'-\w'D'u'\v'-.11m'\z\(hy\v'.11m'\h'|\\n:u'
.ds th \*(#[\v'.3m'\s+1I\s-1\v'-.3m'\h'-(\w'I'u*2/3)'\s-1o\s+1\*(#]
.ds Th \*(#[\s+2I\s-2\h'-\w'I'u*3/5'\v'-.3m'o\v'.3m'\*(#]
.ds ae a\h'-(\w'a'u*4/10)'e
.ds Ae A\h'-(\w'A'u*4/10)'E
.    \" corrections for vroff
.if v .ds ~ \\k:\h'-(\\n(.wu*9/10-\*(#H)'\s-2\u~\d\s+2\h'|\\n:u'
.if v .ds ^ \\k:\h'-(\\n(.wu*10/11-\*(#H)'\v'-.4m'^\v'.4m'\h'|\\n:u'
.    \" for low resolution devices (crt and lpr)
.if \n(.H>23 .if \n(.V>19 \
\{\
.    ds : e
.    ds 8 ss
.    ds o a
.    ds d- d\h'-1'\(ga
.    ds D- D\h'-1'\(hy
.    ds th \o'bp'
.    ds Th \o'LP'
.    ds ae ae
.    ds Ae AE
.\}
.rm #[ #] #H #V #F C
.\" ========================================================================
.\"
.\" Define a properly typeset version of the name "coNCePTuaL".
.ie t .ds co \s-2CO\s+2NC\s-2E\s+2PT\s-2UA\s+2L
.el   .ds co coNCePTuaL
.
.IX Title "NCPTL-LOGMERGE 1"
.TH NCPTL-LOGMERGE 1 "4 March 2011" "1.2f" " "
.\" For nroff, turn off justification.  Always turn off hyphenation; it makes
.\" way too many mistakes in technical documents.
.if n .ad l
.nh
.SH "NAME"
ncptl\-logmerge \- Merge \*(co log files
.SH "SYNOPSIS"
.IX Header "SYNOPSIS"
ncptl-logmerge
\&\fB\-\-usage\fR | \fB\-\-help\fR | \fB\-\-man\fR
.PP
ncptl-logmerge
[\fB\-\-output\fR=\fIfilename\fR]
[\fB\-\-simplify\fR]
\&\fIfilename\fR...
.SH "DESCRIPTION"
.IX Header "DESCRIPTION"
A \*(co program produces one log file per process.  For large
numbers of processes the result can be unwieldy.  \fBncptl-logmerge\fR
combines a large set of log files into a single, merged file which can
later be expanded back into its constituent log files.  There are a
number of restrictions on the input to \fBncptl-logmerge\fR; see
\&\*(L"\s-1RESTRICTIONS\s0\*(R" for details.
.PP
The merged output file does not modify lines which are identical in
all of the input files.  Lines which do differ across input files are
prefixed with the processors and processor ranges in which they
appeared.
.PP
As an example, the following text was extracted from a set of 186
\*(co log files (from a 186\-processor run):
.PP
.Vb 10
\&    # Microsecond timer type: PAPI_get_real_usec()
\&    # Average microsecond timer overhead: <1 microsecond
\&    #[0\-4,6\-12,14\-16,18\-52,54\-78,80\-94,96\-101,103\-121,123\-140,142\-169,
\&      171\-185]# Microsecond timer increment: 1 +/\- 0 microseconds
\&      (ideal: 1 +/\- 0)
\&    #[5]# Microsecond timer increment: 1.00229 +/\- 0.15854
\&      microseconds (ideal: 1 +/\- 0)
\&    #[13]# Microsecond timer increment: 1.00228 +/\- 0.158442
\&      microseconds (ideal: 1 +/\- 0)
\&    #[17,79]# Microsecond timer increment: 1.00228 +/\- 0.158392
\&      microseconds (ideal: 1 +/\- 0)
\&    #[53]# Microsecond timer increment: 1.00228 +/\- 0.158409
\&      microseconds (ideal: 1 +/\- 0)
\&    #[102]# Microsecond timer increment: 1.00228 +/\- 0.158458
\&      microseconds (ideal: 1 +/\- 0)
\&    #[95,122]# Microsecond timer increment: 1.00228 +/\- 0.158474
\&      microseconds (ideal: 1 +/\- 0)
\&    #[141]# Microsecond timer increment: 1.00228 +/\- 0.158491
\&      microseconds (ideal: 1 +/\- 0)
\&    #[170]# Microsecond timer increment: 1.00228 +/\- 0.158524
\&      microseconds (ideal: 1 +/\- 0)
.Ve
.PP
All of the input files contained the same \f(CW\*(C`Microsecond timer type\*(C'\fR
and \f(CW\*(C`Average microsecond timer overhead\*(C'\fR lines.  However, the
measured \f(CW\*(C`Microsecond timer increment\*(C'\fR varied across input files.
While many of the processors observed an increment of \f(CW\*(C`1 +/\- 0\*(C'\fR,
processor\ 5 was alone in observing \f(CW\*(C`1.00229 +/\- 0.15854\*(C'\fR;
processor\ 13 was alone in observing \f(CW\*(C`1.00228 +/\- 0.158442\*(C'\fR; and,
both processor\ 17 and processor\ 79 observed \f(CW\*(C`1.00228 +/\-
0.158392\*(C'\fR as the timer increment.
.PP
\&\fBncptl-logmerge\fR can also be instructed to output only the lines
which differ across files.  Common lines are not output.  This feature
is useful for discovering misconfigured nodes in a large computer
system.  For example, on one computer system on which \*(co was
run, five processors were running at a higher clock rate than the
remainder which naturally affected performance.  \fBncptl-logmerge\fR can
be used to help identify such outliers.
.SH "OPTIONS"
.IX Header "OPTIONS"
\&\fBncptl-logmerge\fR accepts the following command-line options:
.IP "\fB\-u\fR, \fB\-\-usage\fR" 6
.IX Item "-u, --usage"
Output \*(L"\s-1SYNOPSIS\s0\*(R" then exit the program.
.IP "\fB\-h\fR, \fB\-\-help\fR" 6
.IX Item "-h, --help"
Output \*(L"\s-1SYNOPSIS\s0\*(R" and \*(L"\s-1OPTIONS\s0\*(R" then exit the program.
.IP "\fB\-m\fR, \fB\-\-man\fR" 6
.IX Item "-m, --man"
Output a complete Unix man (\*(L"manual\*(R") page for \fBncptl-logmerge\fR then
exit the program.
.IP "\fB\-o\fR \fIfilename\fR, \fB\-\-output\fR=\fIfilename\fR" 6
.IX Item "-o filename, --output=filename"
\&\fBncptl-logmerge\fR normally writes to the standard output device.  The
\&\f(CW\*(C`\-\-output\*(C'\fR option redirects \fBncptl-logmerge\fR's output to a file.
.IP "\fB\-s\fR, \fB\-\-simplify\fR" 6
.IX Item "-s, --simplify"
Simplify the output by including only lines which differ across input
files.  No data is output, only prologue and epilogue comments.
\&\f(CW\*(C`\-\-simplify\*(C'\fR can be specified up to four times on the command line:
.RS 6
.IP "once" 12
.IX Item "once"
Omit all comments and all lines which are identical across all input
files.
.IP "twice" 12
.IX Item "twice"
Lines which differ across \fIall\fR output files (e.g., \f(CW\*(C`Processor
(0<=P<tasks)\*(C'\fR) are also omitted.
.IP "three times" 12
.IX Item "three times"
The amount of output is further reduced by rounding to two significant
digits all numbers appearing in all input files.  Doing so makes
\&\f(CW\*(C`1.10644 +/\- 0.593714\*(C'\fR match \f(CW\*(C`1.12511 +/\- 0.58829\*(C'\fR, for example.
(Both are converted to \f(CW\*(C`1.1 +/\- 0.59\*(C'\fR.)
.IP "four times" 12
.IX Item "four times"
Lists of processors are replaced by the list size.  For example,
\&\f(CW\*(C`#[22,67,86,430]\*(C'\fR becomes \f(CW\*(C`#[4]\*(C'\fR.
.RE
.RS 6
.Sp
Note that \f(CW\*(C`\-\-simplify\*(C'\fR is intended as a diagnostic tool; files output
using \f(CW\*(C`\-\-simplify\*(C'\fR cannot be un-merged to recover the original input
files.
.RE
.PP
In addition to the preceding options \fBncptl-logmerge\fR requires a list
of log files to merge.  If a directory is specified, all of the files
immediately under that directory are used.  (Note that
\&\fBncptl-logmerge\fR does not descend into subdirectories, however.)
Files containing lists of filenames can be specified with a leading
at\ sign ("\f(CW\*(C`@\*(C'\fR").  For example, \f(CW\*(C`@filelist.txt\*(C'\fR means to read a
list of filenames from \f(CW\*(C`@filelist.txt\*(C'\fR.  Filenames beginning with an
at\ sign can be specified by doubling the at\ sign on the command
line.
.SH "DIAGNOSTICS"
.IX Header "DIAGNOSTICS"
.ie n .IP "\fIfilename\fR ""does not look like an unmerged \*(co log file""" 6
.el .IP "\fIfilename\fR \f(CWdoes not look like an unmerged \*(co log file\fR" 6
.IX Item "filename does not look like an unmerged \*(co log file"
\&\fBncptl-logmerge\fR accepts as input only log files produced directly by
a \*(co program.  It is not a general-purpose file combiner nor
does it accept its own output as input.  Unrecognized input files
cause \fBncptl-logmerge\fR to abort with the preceding error message.
.ie n .IP """No process rank found in"" \fIfilename\fR" 6
.el .IP "\f(CWNo process rank found in\fR \fIfilename\fR" 6
.IX Item "No process rank found in filename"
\&\fBncptl-logmerge\fR needs to map filenames to process ranks to indicate
which ranks produced which lines of output.  If an input file does not
contain a \f(CW\*(C`Rank (0<=P<tasks)\*(C'\fR comment, \fBncptl-logmerge\fR
aborts with the preceding error message.
.SH "EXAMPLES"
.IX Header "EXAMPLES"
Merge a set of \*(co log files:
.PP
.Vb 1
\&    ncptl\-logmerge mybenchmark\-[0\-9]*.log > mybenchmark\-all.log
.Ve
.PP
The following command is equivalent to the preceding one:
.PP
.Vb 1
\&    ncptl\-logmerge mybenchmark\-[0\-9]*.log \-\-output=mybenchmark\-all.log
.Ve
.PP
Show only \*(L"interesting\*(R" differences among the input files:
.PP
.Vb 1
\&    ncptl\-logmerge \-\-simplify \-\-simplify mybenchmark\-[0\-9]*.log
.Ve
.PP
For convenience, one can abbreviate \f(CW\*(C`\-\-simplify\*(C'\fR \f(CW\*(C`\-\-simplify\*(C'\fR
\&\f(CW\*(C`\-\-simplify\*(C'\fR \f(CW\*(C`\-\-simplify\*(C'\fR to \f(CW\*(C`\-s\*(C'\fR\ \f(CW\*(C`\-s\*(C'\fR\ \f(CW\*(C`\-s\*(C'\fR\ \f(CW\*(C`\-s\*(C'\fR or even
\&\f(CW\*(C`\-ssss\*(C'\fR:
.PP
.Vb 1
\&    ncptl\-logmerge \-ssss mybenchmark\-[0\-9]*.log
.Ve
.SH "RESTRICTIONS"
.IX Header "RESTRICTIONS"
The log files passed to \fBncptl-logmerge\fR are subject to the following
restrictions:
.IP "\(bu" 4
All files must be produced by the same run of the same \*(co
program.
.IP "\(bu" 4
None of the files can have been previously merged by \fBncptl-logmerge\fR
(i.e., \fBncptl-logmerge\fR can't read its own output).
.IP "\(bu" 4
Only the first filename passed to \fBncptl-logmerge\fR is allowed to
contain data.  Data from all other files is discarded with a warning
message.
.SH "BUGS"
.IX Header "BUGS"
\&\fBncptl-logmerge\fR is not a particularly robust script.  Specifically,
it is confused when input files contain different numbers of comment
lines.  For example, if one input file includes more environment
variables than another or issued a warning about a timer where another
input file didn't, \fBncptl-logmerge\fR will erroneously report all
subsequent lines as being mismatched across input files.
.SH "SEE ALSO"
.IX Header "SEE ALSO"
\&\fIncptl\-logunmerge\fR\|(1), \fIncptl\-logextract\fR\|(1), the \*(co User's Guide
.SH "AUTHOR"
.IX Header "AUTHOR"
Scott Pakin, \fIpakin@lanl.gov\fR
